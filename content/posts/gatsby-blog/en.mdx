---
title: "Blog made by Gatsby"
author: "onichandame"
date: 2019-05-25
---

<!-- vim-markdown-toc GFM -->

* [Background](#background)
* [Challenges](#challenges)
  * [Static Site Generation](#static-site-generation)
  * [Markdown and JSX](#markdown-and-jsx)

<!-- vim-markdown-toc -->

Having read [this blog][why-self-host], I am convinced to host my personal blog. The most convncing point is that self-hosting blogs give more ways to monetize. Every developer is keen on monetizing his/her skills, just like me.

So the strategy has been made. Only tactics left undecided. There are 2 ways to build a self-hosted blog in general: using a blog builder such as WordPress, or build from "scratch". The difference between these 2 options is not actually well defined. I personally consider a tool requiring not web development skills as a blog builder.

As a half-frontend-developer, I decided to use a proper develper's framework for the job: [Gatsby][gatsby].

# Background

[Gatsby][gatsby] is a multi-page website generator based on React.js . The stack can be visualized as follows:

![stack](/image/gatsby-stack.png)

It can be seen that to use Gatsby, the user is expected to know HTML, CSS, JS, TS and React. Thus it is a great opportunity to self-learn frontend skills.

# Challenges

Before diving into this project, I had no knowledge of Gatsby as a framework. Thus the path I took to learn is also applicable for any other newbie developer who wish to learn Gatsby.

## Static Site Generation

As a Next.js developer, I am used to use server-side code during runtime. However it is forbidden for Gatsby as a Static Site Generator(SSG). This descrepancy has lead me to a dead end for many times. So these are the differences between SSG and SSR(Server Side Rendering):

| SSR                               | SSG                                        |
|-----------------------------------|--------------------------------------------|
| allow server side code at runtime | does not allow server side code at runtime |
| shipped with server executable    | shipped as plain html/css/... files        |
| dynamically generate pages        | requires rebuild to change page content    |

Based on the principle of SSG, 3 baselines need to be followed:

1. separate codes for buildtime and code for runtime
2. write runtime code as if writing in browser's dev tool
3. make sure all data can be statically fetched at buildtime

## Internationalization

Working in a non-English-speaking country, it is necessary to serve audience from both English background and Chinese background. Thus my blog needs to serve contents in both English and Chinese. This is one of the considerations I took when I decided to make my own blogger as no other blogger is popular in both China and the outside world.

Coming to the implementation part, there are several tools and examples available online that can guide me.

### Gatsby Plugin i18n

The first approach I tried was using a gatsby plugin. This is the best option for a non-blog site. I have used a similar tool for Next.js so this is not too hard to catch up. However this tool does not suit the needs of a blog site as it only provides field level translation. A blog utilizing field level translation is extremely difficult to maintain as all translation sources are kept in JSON files. A blog stored in JSON? No...

### Translate Myself

According to [the official guide](https://github.com/gatsbyjs/gatsby/tree/master/examples/using-i18n/), it is possible to achieve field level translation and page level translation at the same time.

## Markdown and JSX

The most significant difference between a blog and a regular site is that blogs are served in virtually the same layout. For the ease of maintenance, it would be better to keep the source of the blogs in a stable file format that has not changed in the past 10 years. It would also be beneficial if the source and the output are very similar so that overhead is small, and it is visually clear during writing.

Combining the above considerations, markdown is the best option. Markdown standard is very stable. Although some improvements have been added in the past few years, all plugins keep a very good interoperability and and good backward compatibility.

[gatsby]: https://www.gatsbyjs.org
[why-self-host]: https://bloggingexplorer.com/self-hosted-blog
[i18n]: https://github.com/angeloocana/gatsby-plugin-i18n
[heading-anchor]: https://johno.com/mdx-table-of-contents-components-in-gatsby
